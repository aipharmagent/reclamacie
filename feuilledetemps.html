<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Feuille de temps – Labo</title>
<style>
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    margin: 0.5cm;
    background: #fff;
    font-size: 12pt;
    line-height: 1.3;
  }
  h1 {
    text-align: center;
    margin: 0.3cm 0 0.6cm 0;
    font-size: 18pt;
    font-weight: bold;
  }
  #controls {
    text-align: center;
    margin-bottom: 0.6cm;
    font-size: 12pt;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
    margin-bottom: 0.8cm;
  }
  th, td {
    border: 1.5px solid #000;
    padding: 7px 4px;
    text-align: center;
    vertical-align: middle;
  }
  th {
    background: #d0e6ff;
    font-weight: bold;
    font-size: 12pt;
  }
  td:first-child {
    background: #f5f8ff;
    font-weight: bold;
    width: 15%;
  }
  input {
    width: 100%;
    border: none;
    background: transparent;
    text-align: center;
    font-size: 11pt;
    font-family: inherit;
    padding: 0;
    margin: 0;
  }
  td[contenteditable="true"] {
    background: #fff !important;
    font-weight: bold;
  }

  @media print {
    @page {
      size: A4 landscape;
      margin: 0.5cm !important;
    }
    body { margin: 0; padding: 0; }
    #controls, button { display: none !important; }
    h1 { margin: 0.2cm 0 0.5cm 0; font-size: 17pt; }
    table { margin-bottom: 0.6cm; }
    th, td { padding: 6px 3px; font-size: 10.5pt; }
    th { background: #d0e6ff !important; }
  }
</style>
</head>
<body>

<h1>Pharmacie Luu Thi Thanh Thao - Feuille de temps (Labo)</h1>

<div id="controls">
  <label>
    Premier lundi de la période :
    <input type="date" id="startDate" onchange="generateTables()">
  </label>
</div>

<div id="weeks"></div>

<button onclick="window.print()" style="margin-top:1rem; padding:8px 20px; font-size:14pt;">Imprimer</button>

<script>
const DAYS = ['Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi'];
const DEFAULT_NAMES = ['Florence','Danny','Thanh','Dung','Mai Lan','Cecilia','Hien'];

function generateTables() {
  const input = document.getElementById('startDate').value;
  if (!input) return;

  const start = new Date(input);
  const day = start.getDay() || 7;
  start.setDate(start.getDate() + (8 - day)); // prochain lundi

  const container = document.getElementById('weeks');
  container.innerHTML = '';

  addWeek(container, new Date(start));           // Semaine 1
  const week2 = new Date(start);
  week2.setDate(start.getDate() + 7);
  addWeek(container, week2);                     // Semaine 2
}

function addWeek(parent, mondayDate) {
  const div = document.createElement('div');
  div.style.pageBreakAfter = 'avoid';

  let html = `<table>
    <thead>
      <tr>
        <th rowspan="2" style="width:11%;"></th>`;
  for (let i = 0; i < 6; i++) {
    const d = new Date(mondayDate);
    d.setDate(mondayDate.getDate() + i);
    const day = d.getDate();
    const month = d.getMonth() + 1;
    html += `<th>${day}/${month}</th>`;
  }
  html += `</tr><tr>`;
  for (let i = 0; i < 6; i++) html += `<th>${DAYS[i]}</th>`;
  html += `</tr></thead><tbody>`;

  DEFAULT_NAMES.forEach(name => {
    html += `<tr>
      <td contenteditable="true" style="font-weight:bold;">${name}</td>`;
    for (let i = 0; i < 6; i++) {
      html += `<td><input type="text" placeholder=""></td>`;
    }
    html += `</tr>`;
  });

  html += `</tbody></table>`;
  div.innerHTML = html;
  parent.appendChild(div);
}
</script>

</body>
</html>
